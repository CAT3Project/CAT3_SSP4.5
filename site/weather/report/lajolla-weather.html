<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" href="../style/weather.css">
    <style>
        .left-top {
            background-image: url('../sources/background/la_jolla.jpeg');
            background-position: center;
            border-radius: 40px 0px 0px 0px;
        }
    </style>
</head>

<body>
    <div class="body-outer">
        <form action="https://cat3project.github.io/CAT3_SSP4.5/site/home/index.html" class="home-button-div">
            <input type="submit" value="Home" class="home-button" />
        </form>
        <div class="body-inner">
            <div class="column-left">
                <div class="left-top">
                    <!-- <h1 class="left-title">Weather Forecast</h1> -->
                </div>
                <div class="day-block d1">
                    Monday
                    <img class="icon" src="../sources/weather_icons/cloudy.png" />
                    <h2 class="temp-day" id="d1-tempF"></h2>
                </div>
                <div class="day-block d2">
                    Tuesday
                    <img class="icon" src="../sources/weather_icons/partly_cloudy.png" />
                    <h2 class="temp-day">60F &deg</h2>
                </div>
                <div class="day-block d3">
                    Wednesday
                    <img class="icon" src="../sources/weather_icons/cloudy.png" />
                    <h2 class="temp-day">60F &deg</h2>
                </div>
                <div class="day-block d4">
                    Thursday
                    <img class="icon" src="../sources/weather_icons/cloudy.png" />
                    <h2 class="temp-day">60F &deg</h2>
                </div>
                <div class="day-block d5">
                    Friday
                    <img class="icon" src="../sources/weather_icons/sunny.png" />
                    <h2 class="temp-day">60F &deg</h2>
                </div>
                <div class="day-block d6">
                    Saturday
                    <img class="icon" src="../sources/weather_icons/thunder.png" />
                    <h2 class="temp-day">60F &deg</h2>
                </div>
                <div class="day-block d7">
                    Sunday
                    <img class="icon" src="../sources/weather_icons/cloudy.png" />
                    <h2 class="temp-day">60F &deg</h2>
                </div>
            </div>
            <div class="column-right">
                <div class="right-temp">
                    <div class="title">
                        <!-- Today -->
                        <div id="location"></div>
                    </div>
                    <h1 id="tempF"></h1>
                    <div id="des"></div>
                </div>
                <div class="date-div">
                    <h1 id="date" class="date"></h1>
                </div>
            </div>
        </div>

        <div>
            <script lang="text/javascript">
                function weatherBalloon(cityID) {
                    var key = 'bb4ee933060dc46241b9d5341d6f9368';
                    fetch('https://api.openweathermap.org/data/2.5/weather?id=' + cityID + '&appid=' + key)
                        .then(function (resp) { return resp.json() })
                        .then(function (data) {
                            drawWeather(data);
                        })
                        .catch(function () {
                        });
                    //api.openweathermap.org/data/2.5/forecast/climate?q=London&cnt=3
                    fetch('https://api.openweathermap.org/data/2.5/weather?id=' + cityID + '&cnt=7&appid=' + key)
                        .then(function (resp) { return resp.json() })
                        .then(function (data) {
                            drawTemperature(data, "d1");
                        })
                        .catch(function () {
                        });
                }
                function drawWeather(data) {
                    var celcius = Math.round(parseFloat(data.main.temp) - 273.15) + 2;
                    var fahrenheit = Math.round(((parseFloat(data.main.temp) - 273.15) * 1.8) + 34);

                    document.getElementById("des").innerHTML = data.weather[0].description;
                    document.getElementById("tempF").innerHTML = fahrenheit + 'F &deg;';
                    document.getElementById("location").innerHTML = data.name;
                }

                function drawTemperature(data, day) {
                    // var celcius = Math.round(parseFloat(data.main.temp) - 273.15) + 2;
                    var fahrenheit = Math.round(((parseFloat(data.main.temp) - 273.15) * 1.8) + 34);
                    // document.getElementById(day + "tempF").innerHTML = fahrenheit + 'F &deg;';
                    document.getElementById(day + "-tempF").innerHTML = fahrenheit + 'F &deg;';
                }

                function getDate() {
                    today = new Date();
                    let monthString = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
                    var dd = today.getDate();
                    var mm = today.getMonth();
                    var yyyy = today.getFullYear();
                    if (dd % 10 == 1) {
                        var dateFull = monthString[mm] + ' ' + dd + 'st, ' + yyyy;
                    } else if (dd % 10 == 2) {
                        var dateFull = monthString[mm] + ' ' + dd + 'nd, ' + yyyy;
                    } else if (dd % 10 == 3) {
                        var dateFull = monthString[mm] + ' ' + dd + 'rd, ' + yyyy;
                    } else {
                        var dateFull = monthString[mm] + ' ' + dd + 'th, ' + yyyy;
                    }
                    document.getElementById("date").innerHTML = dateFull;
                }

                window.onload = function () {
                    weatherBalloon(5363943);
                    getDate();
                }
            </script>
        </div>
    </div>
</body>

</html>